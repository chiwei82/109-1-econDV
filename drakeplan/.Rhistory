a <- 3
cc <- 15
examplePlan <- drake::drake_plan(
target1 = {
a + 5 -> b
cc <- 0
if (b < 10) b
},
target2 = {
cc
},
target3 = {
target1 + a
}
)
View(examplePlan)
make(examplePlan)
readd(target1)
readd(target2)
readd(target3)
loadd(target1)
loadd(target2)
loadd(target3)
make(examplePlan)
readd(target1)
readd(target2)
readd(target3)
loadd(target1)
loadd(target2)
loadd(target3)
loadd(target1)
loadd(target2)
loadd(target3)
loadd(target1)
loadd(target2)
loadd(target3)
loadd(target1)
loadd(target2)
loadd(target3)
readd(target1)
readd(target2)
readd(target3)
loadd(target1)
loadd(target2)
loadd(target3)
clean()
vis_drake_graph(examplePlan)
make(examplePlan)
vis_drake_graph(examplePlan)
planExample <-
drake::drake_plan(
target1 = {
download.file("https://.....")
},
:
:
targetN = {
save(someObject, "myResult.rda")
}
)
file.edit(".Rprofile")
planExample <-
drake::drake_plan(
target1 = {
download.file("https://.....")
},
targetN = {
save(someObject, "myResult.rda")
}
)
planExample <-
drake::drake_plan(
target1 = {
download.file(file_in("https://....."))
},
targetN = {
save(someObject, file_out("myResult.rda"))
}
)
Attach() # attach .R_Cache
obj1 <- 5
Store(obj1)
obj1 <- 3 # Won't change obj1 in cache, but create an obj1 in global environment.
Store(obj1) # Unless store it in cache.
Remove(obj1)
library(SOAR)
Attach() # attach .R_Cache
obj1 <- 5
Store(obj1)
obj1 <- 3 # Won't change obj1 in cache, but create an obj1 in global environment.
Store(obj1) # Unless store it in cache.
Remove(obj1)
canvas = {
ggplot()
}
ggline <- {
canvas +
geom_line(
aes(x = 西元年月, y = `定存利率-一個月-固定`),
subsetDataTWbank
)
}
# Chunk 1: setup
# Chunk 2: makecondition
library(readr)
library(ggplot2)
library(drake)
library(rmd2drake)
library(dplyr)
library(showtext)
library(stringr)
showtext_auto()
theme(
text=element_text(family = "Noto Sans TC")
) %>%
theme_set()
rprojroot::is_rstudio_project -> pj
pj$make_fix_file() -> root
# Chunk 3: big5bankInterestRates
big5bankInterestRates = read_csv("https://www.cbc.gov.tw/public/data/OpenData/A13Rate.csv")
# Chunk 4: subsetDataTWbank
subsetDataTWbank = {
big5bankInterestRates %>%
mutate(
年月日={
191100+as.integer(年月) -> mockDate
paste0(stringr::str_sub(mockDate,1,4),"-",str_sub(mockDate,5,6),"-01") # 加了01日
},
西元年月=lubridate::ymd(年月日)
)  %>%
select(
"銀行", "西元年月",
matches("定存利率-([一三六]個月|[一二三]年期)-固定")
) %>%
filter(
銀行=="臺灣銀行"
)
}
# Chunk 5: subsetDataTWbank
subsetDataTWbank = read_csv(
file_in("https://www.dropbox.com/s/t8ulj3d7cgl8jh5/subsetDataTWbank.csv?dl=1"))
# Chunk 6: canvas
canvas = {
ggplot()
}
# Chunk 7: ggline
ggline <- {
canvas +
geom_line(
aes(x = 西元年月, y = `定存利率-一個月-固定`),
subsetDataTWbank
)
}
# Chunk 8: ggLinePoint
ggLinePoint={
ggline +
geom_point(
mapping=aes(x=西元年月,y=`定存利率-一個月-固定`),
subsetDataTWbank
)
}
# Chunk 9: ggpoint
ggpoint <- {
ggline +
geom_point(
aes(x = 西元年月, y = `定存利率-一個月-固定`),
subsetDataTWbank
)
}
# Chunk 10: ggline3M
ggline3M <- {
ggline +
geom_line(
aes(x = 西元年月, y = `定存利率-三個月-固定`),
subsetDataTWbank
)
}
# Chunk 11: ggline3M
ggline3M <- {
ggline +
geom_line(
aes(x = 西元年月, y = `定存利率-三個月-固定`),
subsetDataTWbank,
color="blue"
)
}
# Chunk 12: ggline1Y
ggline1Y = {
ggline3M +
geom_line(
aes(x = 西元年月, y = `定存利率-一年期-固定`),
subsetDataTWbank,
color="green"
)
}
# Chunk 13: ggline2Y3Y
ggline2Y3Y = {
ggline1Y +
geom_line(
aes(x = 西元年月, y = `定存利率-二年期-固定`),
subsetDataTWbank,
color="brown"
) +
geom_line(
aes(x = 西元年月, y = `定存利率-三年期-固定`),
subsetDataTWbank,
color="red"
)
}
# Chunk 14: canvas2
canvas2 = ggplot(data=subsetDataTWbank)
# Chunk 15: ggline2Y3Y
ggline2Y3Y = {
canvas +
geom_line(
aes(x = 西元年月, y = `定存利率-一個月-固定`),
subsetDataTWbank
) +
geom_line(
aes(x = 西元年月, y = `定存利率-三個月-固定`),
subsetDataTWbank,
color = "blue"
) +
geom_line(
aes(x = 西元年月, y = `定存利率-一年期-固定`),
subsetDataTWbank,
color = "green"
) +
geom_line(
aes(x = 西元年月, y = `定存利率-二年期-固定`),
subsetDataTWbank,
color = "brown"
) +
geom_line(
aes(x = 西元年月, y = `定存利率-三年期-固定`),
subsetDataTWbank,
color = "red"
)
}
# Chunk 16: ggline2Y3Y_2
ggline2Y3Y_2 = {
canvas2 +
geom_line(
aes(x = 西元年月, y = `定存利率-一個月-固定`)
) +
geom_line(
aes(x = 西元年月, y = `定存利率-三個月-固定`),
color = "blue"
) +
geom_line(
aes(x = 西元年月, y = `定存利率-一年期-固定`),
color = "green"
) +
geom_line(
aes(x = 西元年月, y = `定存利率-二年期-固定`),
color = "brown"
) +
geom_line(
aes(x = 西元年月, y = `定存利率-三年期-固定`),
color = "red"
)
}
# Chunk 17: ggTwbInterestRates
ggTwbInterestRates= {
ggline2Y3Y +
labs(
title="臺灣銀行不同期限定存利率",
subtitle="固定利率，單位：% 年率",
caption="資料出處: 政府開放資料平台https://data.gov.tw/dataset/10359",
y="",
x=""
)+theme_classic()
}
# Chunk 18: ggTwbInterestRates
ggTwbInterestRates_bw= {
ggTwbInterestRates +
theme_bw()
}
# Chunk 19: saveGgline
saveGgline = {
ggsave(
ggTwbInterestRates,
file="img/ggTwbInterestRates.svg" ,
width=8, height=5)
}
# Chunk 20
svgOpen(
file.path(
root(),"img/ggTwbInterestRates.svg"
)
)
rmd2drake:::visActiveRmd_plan()
ggline
ggLinePoint={
ggline +
geom_point(
mapping=aes(x=西元年月,y=`定存利率-一個月-固定`),
subsetDataTWbank
)
}
ggLinePoint
svgOpen(
file.path(
root(),"img/ggTwbInterestRates.svg"
)
)
install.packages("svg")
library(svglite)
svgOpen(
file.path(
root(),"img/ggTwbInterestRates.svg"
)
)
install.packages("svgViewR")
library(svgViewR)
svgOpen(
file.path(
root(),"img/ggTwbInterestRates.svg"
)
)
# Chunk 1: setup
# Chunk 2: makecondition
library(readr)
library(ggplot2)
library(drake)
library(rmd2drake)
library(dplyr)
library(showtext)
library(stringr)
showtext_auto()
theme(
text=element_text(family = "Noto Sans TC")
) %>%
theme_set()
rprojroot::is_rstudio_project -> pj
pj$make_fix_file() -> root
# Chunk 3: big5bankInterestRates
big5bankInterestRates = read_csv("https://www.cbc.gov.tw/public/data/OpenData/A13Rate.csv")
# Chunk 4: subsetDataTWbank
subsetDataTWbank = {
big5bankInterestRates %>%
mutate(
年月日={
191100+as.integer(年月) -> mockDate
paste0(stringr::str_sub(mockDate,1,4),"-",str_sub(mockDate,5,6),"-01") # 加了01日
},
西元年月=lubridate::ymd(年月日)
)  %>%
select(
"銀行", "西元年月",
matches("定存利率-([一三六]個月|[一二三]年期)-固定")
) %>%
filter(
銀行=="臺灣銀行"
)
}
# Chunk 5: subsetDataTWbank
subsetDataTWbank = read_csv(
file_in("https://www.dropbox.com/s/t8ulj3d7cgl8jh5/subsetDataTWbank.csv?dl=1"))
# Chunk 6: canvas
canvas = {
ggplot()
}
# Chunk 7: ggline
ggline <- {
canvas +
geom_line(
aes(x = 西元年月, y = `定存利率-一個月-固定`),
subsetDataTWbank
)
}
# Chunk 8: ggLinePoint
ggLinePoint={
ggline +
geom_point(
mapping=aes(x=西元年月,y=`定存利率-一個月-固定`),
subsetDataTWbank
)
}
# Chunk 9: ggpoint
ggpoint <- {
ggline +
geom_point(
aes(x = 西元年月, y = `定存利率-一個月-固定`),
subsetDataTWbank
)
}
# Chunk 10: ggline3M
ggline3M <- {
ggline +
geom_line(
aes(x = 西元年月, y = `定存利率-三個月-固定`),
subsetDataTWbank
)
}
# Chunk 11: ggline3M
ggline3M <- {
ggline +
geom_line(
aes(x = 西元年月, y = `定存利率-三個月-固定`),
subsetDataTWbank,
color="blue"
)
}
# Chunk 12: ggline1Y
ggline1Y = {
ggline3M +
geom_line(
aes(x = 西元年月, y = `定存利率-一年期-固定`),
subsetDataTWbank,
color="green"
)
}
# Chunk 13: ggline2Y3Y
ggline2Y3Y = {
ggline1Y +
geom_line(
aes(x = 西元年月, y = `定存利率-二年期-固定`),
subsetDataTWbank,
color="brown"
) +
geom_line(
aes(x = 西元年月, y = `定存利率-三年期-固定`),
subsetDataTWbank,
color="red"
)
}
# Chunk 14: canvas2
canvas2 = ggplot(data=subsetDataTWbank)
# Chunk 15: ggline2Y3Y
ggline2Y3Y = {
canvas +
geom_line(
aes(x = 西元年月, y = `定存利率-一個月-固定`),
subsetDataTWbank
) +
geom_line(
aes(x = 西元年月, y = `定存利率-三個月-固定`),
subsetDataTWbank,
color = "blue"
) +
geom_line(
aes(x = 西元年月, y = `定存利率-一年期-固定`),
subsetDataTWbank,
color = "green"
) +
geom_line(
aes(x = 西元年月, y = `定存利率-二年期-固定`),
subsetDataTWbank,
color = "brown"
) +
geom_line(
aes(x = 西元年月, y = `定存利率-三年期-固定`),
subsetDataTWbank,
color = "red"
)
}
# Chunk 16: ggline2Y3Y_2
ggline2Y3Y_2 = {
canvas2 +
geom_line(
aes(x = 西元年月, y = `定存利率-一個月-固定`)
) +
geom_line(
aes(x = 西元年月, y = `定存利率-三個月-固定`),
color = "blue"
) +
geom_line(
aes(x = 西元年月, y = `定存利率-一年期-固定`),
color = "green"
) +
geom_line(
aes(x = 西元年月, y = `定存利率-二年期-固定`),
color = "brown"
) +
geom_line(
aes(x = 西元年月, y = `定存利率-三年期-固定`),
color = "red"
)
}
# Chunk 17: ggTwbInterestRates
ggTwbInterestRates= {
ggline2Y3Y +
labs(
title="臺灣銀行不同期限定存利率",
subtitle="固定利率，單位：% 年率",
caption="資料出處: 政府開放資料平台https://data.gov.tw/dataset/10359",
y="",
x=""
)+theme_classic()
}
# Chunk 18: ggTwbInterestRates
ggTwbInterestRates_bw= {
ggTwbInterestRates +
theme_bw()
}
# Chunk 19: saveGgline
saveGgline = {
ggsave(
ggTwbInterestRates,
file="img/ggTwbInterestRates.svg" ,
width=8, height=5)
}
# Chunk 20
svgOpen(
file.path(
root(),"img/ggTwbInterestRates.svg"
)
)
rmd2drake:::visActiveRmd_plan()
rmd2drake:::visActiveRmd_plan()
rmd2drake:::visActiveRmd_plan()
